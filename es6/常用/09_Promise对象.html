<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>11_Promise对象</title>
</head>
<body>
<!--
1. 理解:
  * Promise对象: 代表了未来某个将要发生的事件(通常是一个异步操作)
  * 有了promise对象, 可以将异步操作以同步的流程表达出来, 避免了层层嵌套的回调函数(俗称'回调地狱')
  * ES6的Promise是一个构造函数, 用来生成promise实例
2. 使用promise基本步骤(2步):
  * 创建promise对象
    let promise = new Promise((resolve, reject) => {
        //初始化promise状态为 pending
      //执行异步操作
      if(异步操作成功) {
        resolve(value);//修改promise的状态为fullfilled
      } else {
        reject(errMsg);//修改promise的状态为rejected
      }
    })
  * 调用promise的then()
    promise.then(function(
      result => console.log(result),
      errorMsg => alert(errorMsg)
    ))
3. promise对象的3个状态
  * pending: 初始化状态
  * fullfilled: 成功状态
  * rejected: 失败状态
4. 应用:
  * 使用promise实现超时处理

  * 使用promise封装处理ajax请求
    let request = new XMLHttpRequest();
    request.onreadystatechange = function () {
    }
    request.responseType = 'json';
    request.open("GET", url);
    request.send();
-->

<script type="text/javascript">
	// 创建一个Promise实例对象
	// let promise=new Promise((resolve,reject)=>{
	// 	//初始化promise的状态为pending---->初始化状态
	// 	console.log('promise新建后立即执行');
	// 	resolve('success');//修改promise的状态pending---->fullfilled（成功状态）
	// 	// reject('error');//修改promise的状态pending----->rejected(失败状态)
	// })
	// promise.then((res)=>{
	// 	console.log('异步任务:'+res)
	// },(err)=>{
	// 	console.log('异步任务:'+err);
	// })
	// console.log('同步任务')
	
	
	// 模拟异步操作
 //    let promise = new Promise((resolve, reject) => {
 //        console.log('1111');//同步执行
 //        //启动异步任务,一段耗时的异步操作
 //        setTimeout(function () {
 //            console.log('3333');
 //            resolve('success');
 //        },1000)
 //    });
 //    promise.then((data) => {
 //        console.log('成功了。。。' + data);
 //    }, (error) => {
 //        console.log('失败了' + error);
 //    })
	// .catch(error=>{
	// 	console.log(error);
	// })
 //    console.log('2222');//同步执行
 
 
   new Promise((resolve,reject)=>{
	  setTimeout(()=>{
		 let data=100; 
		 resolve(data)
	  },1000)
   }).then((value)=>{
	   return new Promise((resolve,reject)=>{
		   setTimeout(()=>{
			  console.log(value);//上一次的结果
			  resolve(value+10)
		   },2000)
	   })
   }).then((value)=>{
	   return new Promise((resolve,reject)=>{
		     console.log(value);//上一次的结果
		     resolve(value+10)
	   })
	 
   }).then((value)=>{
	    console.log(value);////上一次的结果
   }).chtch((err)=>{
	   throw new Error(err);
   })

</script>

</body>

</html>